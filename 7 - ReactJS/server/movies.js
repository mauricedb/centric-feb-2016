var movies = [{
    "id": 771028554,
    "title": "127 Hours",
    "year": 2010,
    "mpaaRating": "8.7",
    "criticsConsensus": "As gut-wrenching as it is inspirational, 127 Hours unites one of Danny Boyle's most beautifully exuberant directorial efforts with a terrific performance from James Franco.",
    "synopsis": "James Franco stars in director Danny Boyle's inspiring survival drama based on the incredible true story of Aron Ralston, who became trapped alone in a Utah canyon for days after slipping on a loose rock, and resorted to extraordinary measures in order to make it out of his dire predicament alive. An experienced hiker and climber, Ralston (Franco) is very much in his element when he parks his truck by a mountain near Moab, UT, hops on his bike, and peddles to the middle of nowhere. Later, when Ralston encounters a pair of young female hikers who have gotten lost while searching for a local landmark, he jovially shows them a sight that most casual hikers miss before bidding them farewell and continuing on his way. Drifting through the canyons alone, deep in thought, however, the explorer who presumed he was ready for anything quickly discovers just how fast things can spin out of control when a rock gives way as he shimmies down a crevice, and pins his hand to the unforgiving wall of stone. Over the course of the next 127 hours, Ralston tries everything he can think of to free himself, flashing back to small but memorable events in his life -- as well as forward to the future that he might enjoy should he manage to wiggle free -- as his body begins the slow process of shutting down. Eventually realizing that the only way out is to leave part of himself behind, the exhausted, delirious adventurer draws his cheap made-in-China multi-tool, and does what it takes to survive. ~ Jason Buchanan, Rovi",
    "genres": ["Drama"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/11/15/34/11153440_mob.jpg",
        "profile": "http://content6.flixster.com/movie/11/15/34/11153440_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/11/15/34/11153440_det.jpg",
        "original": "http://content6.flixster.com/movie/11/15/34/11153440_ori.jpg"
    },
    "director": "Danny Boyle"
}, {
    "id": 9917,
    "title": "2001: A Space Odyssey",
    "year": 1968,
    "mpaaRating": "R",
    "criticsConsensus": "One of the most influential of all sci-fi films -- and one of the most controversial -- Stanley Kubrick's 2001 is a delicate, poetic meditation on the ingenuity -- and folly -- of mankind.  cvbc",
    "synopsis": "Test",
    "genres": ["Classics", "Science Fiction & Fantasy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/11/16/80/11168008_mob.jpg",
        "profile": "http://content6.flixster.com/movie/11/16/80/11168008_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/11/16/80/11168008_det.jpg",
        "original": "http://content6.flixster.com/movie/11/16/80/11168008_ori.jpg"
    },
    "director": "Stanley Kubrick"
}, {
    "id": 770795544,
    "title": "2012",
    "year": 2009,
    "mpaaRating": "PG-13",
    "criticsConsensus": "Roland Emmerich's 2012 provides plenty of visual thrills, but lacks a strong enough script to support its massive scope and inflated length.\nfsdafaf asd asda da sdds fsdsfsdf. Pretty cool movie too ;)",
    "synopsis": "",
    "genres": ["Drama", "Action & Adventure", "Mystery & Suspense", "Science Fiction & Fantasy"],
    "posters": {
        "thumbnail": "http://content7.flixster.com/movie/10/95/34/10953481_mob.jpg",
        "profile": "http://content7.flixster.com/movie/10/95/34/10953481_pro.jpg",
        "detailed": "http://content7.flixster.com/movie/10/95/34/10953481_det.jpg",
        "original": "http://content7.flixster.com/movie/10/95/34/10953481_ori.jpg"
    },
    "director": "Roland Emmerich"
}, {
    "id": 770676801,
    "title": "21",
    "year": 2008,
    "mpaaRating": "PG-13",
    "criticsConsensus": "21 could have been a fascinating study had it not supplanted the true story on which it is based with mundane melodrama.",
    "synopsis": "",
    "genres": ["Mystery & Suspense", "Drama"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/10/88/67/10886752_mob.jpg",
        "profile": "http://content6.flixster.com/movie/10/88/67/10886752_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/10/88/67/10886752_det.jpg",
        "original": "http://content6.flixster.com/movie/10/88/67/10886752_ori.jpg"
    },
    "director": "Robert Luketic"
}, {
    "id": 770669912,
    "title": "27 Dresses",
    "year": 2008,
    "mpaaRating": "PG-13",
    "criticsConsensus": "The filmmakers perfectly follow the well-worn romantic comedy formula, rendering 27 Dresses cliched and mostly forgettable.",
    "synopsis": "",
    "genres": ["Comedy", "Romance"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/10/70/11/10701195_mob.jpg",
        "profile": "http://content9.flixster.com/movie/10/70/11/10701195_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/10/70/11/10701195_det.jpg",
        "original": "http://content9.flixster.com/movie/10/70/11/10701195_ori.jpg"
    },
    "director": "Anne Fletcher"
}, {
    "id": 14347,
    "title": "28 Days Later",
    "year": 2003,
    "mpaaRating": "R",
    "criticsConsensus": "28 Days Later is both a terrifying zombie movie and a sharp political allegory.",
    "synopsis": "",
    "genres": ["Science Fiction & Fantasy", "Horror"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/55/37/32/5537323_mob.jpg",
        "profile": "http://content9.flixster.com/movie/55/37/32/5537323_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/55/37/32/5537323_det.jpg",
        "original": "http://content9.flixster.com/movie/55/37/32/5537323_ori.jpg"
    },
    "director": "Danny Boyle"
}, {
    "id": 660304807,
    "title": "28 Weeks Later",
    "year": 2007,
    "mpaaRating": "R",
    "criticsConsensus": "While 28 Weeks Later lacks the humanism that made 28 Days Later a classic, it's made up with fantastic atmosphere and punchy direction.\nsddddddddddddddddddddddddddddddddddd.",
    "synopsis": "",
    "genres": ["Horror", "Mystery & Suspense", "Science Fiction & Fantasy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/10/86/37/10863760_mob.jpg",
        "profile": "http://content6.flixster.com/movie/10/86/37/10863760_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/10/86/37/10863760_det.jpg",
        "original": "http://content6.flixster.com/movie/10/86/37/10863760_ori.jpg"
    },
    "director": "Juan Carlos Fresnadillo"
}, {
    "id": 771041151,
    "title": "30 Minutes or Less",
    "year": 2011,
    "mpaaRating": "R",
    "criticsConsensus": "It's sporadically funny and it benefits from a talented cast, but 30 Minutes or Less suffers from a disjointed narrative, and too often mistakes crude gags for true lowbrow humor.",
    "synopsis": "In the action-comedy 30 Minutes or Less, Nick (Jesse Eisenberg) is a small town pizza delivery guy whose mundane life collides with the big plans of two wanna-be criminal masterminds (Danny McBride and Nick Swardson). The volatile duo kidnaps Nick and forces him to rob a bank. With mere hours to pull off the impossible task, Nick enlists the help of his ex-best friend, Chet (Aziz Ansari). As the clock ticks, the two must deal with the police, hired assassins, flamethrowers, and their own tumultuous relationship. -- (C) Sony",
    "genres": ["Action & Adventure", "Comedy"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/11/16/95/11169563_mob.jpg",
        "profile": "http://content9.flixster.com/movie/11/16/95/11169563_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/11/16/95/11169563_det.jpg",
        "original": "http://content9.flixster.com/movie/11/16/95/11169563_ori.jpg"
    },
    "director": "Ruben Fleischer"
}, {
    "id": 10192,
    "title": "50 First Dates",
    "year": 2004,
    "mpaaRating": "PG-13",
    "criticsConsensus": "Gross-out humor overwhelms the easy chemistry between Adam Sandler and Drew Barrymore, who bring some energy and yucks to this tale of a girl with short-term memory loss and the guy who tries to get her to love him.",
    "synopsis": "",
    "genres": ["Comedy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/11/16/98/11169892_mob.jpg",
        "profile": "http://content6.flixster.com/movie/11/16/98/11169892_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/11/16/98/11169892_det.jpg",
        "original": "http://content6.flixster.com/movie/11/16/98/11169892_ori.jpg"
    },
    "director": "Peter Segal"
}, {
    "id": 770801801,
    "title": "500 Days of Summer",
    "year": 2009,
    "mpaaRating": "PG-13",
    "criticsConsensus": "A clever, offbeat romantic comedy, 500 Days of Summer is refreshingly honest and utterly charming.",
    "synopsis": "",
    "genres": ["Drama", "Romance", "Comedy"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/10/89/13/10891315_mob.jpg",
        "profile": "http://content9.flixster.com/movie/10/89/13/10891315_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/10/89/13/10891315_det.jpg",
        "original": "http://content9.flixster.com/movie/10/89/13/10891315_ori.jpg"
    },
    "director": "Marc Webb"
}, {
    "id": 10240,
    "title": "A Beautiful Mind",
    "year": 2001,
    "mpaaRating": "PG-13",
    "criticsConsensus": "The well-acted A Beautiful Mind is both a moving love story and a revealing look at mental illness.",
    "synopsis": "",
    "genres": ["Drama"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/10/93/45/10934587_mob.jpg",
        "profile": "http://content9.flixster.com/movie/10/93/45/10934587_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/10/93/45/10934587_det.jpg",
        "original": "http://content9.flixster.com/movie/10/93/45/10934587_ori.jpg"
    },
    "director": "Ron Howard"
}, {
    "id": 12976,
    "title": "A Bronx Tale",
    "year": 1993,
    "mpaaRating": "R",
    "criticsConsensus": "A Bronx Tale sets itself apart from other coming-of-age dramas thanks to a solid script, a terrific cast, and director Robert De Niro's sensitive work behind the camera.",
    "synopsis": "",
    "genres": ["Drama"],
    "posters": {
        "thumbnail": "http://content7.flixster.com/movie/10/88/62/10886213_mob.jpg",
        "profile": "http://content7.flixster.com/movie/10/88/62/10886213_pro.jpg",
        "detailed": "http://content7.flixster.com/movie/10/88/62/10886213_det.jpg",
        "original": "http://content7.flixster.com/movie/10/88/62/10886213_ori.jpg"
    },
    "director": "Robert De Niro"
}, {
    "id": 10321,
    "title": "A Cinderella Story",
    "year": 2004,
    "mpaaRating": "PG",
    "criticsConsensus": "An uninspired, generic updating of the classic fairy tale.",
    "synopsis": "",
    "genres": ["Drama", "Kids & Family", "Romance", "Comedy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/11/16/79/11167920_mob.jpg",
        "profile": "http://content6.flixster.com/movie/11/16/79/11167920_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/11/16/79/11167920_det.jpg",
        "original": "http://content6.flixster.com/movie/11/16/79/11167920_ori.jpg"
    },
    "director": "Mark Rosman"
}, {
    "id": 15694,
    "title": "A Clockwork Orange",
    "year": 1971,
    "mpaaRating": "R",
    "criticsConsensus": "Disturbing and thought-provoking, A Clockwork Orange is a cold, dystopian nightmare with a very dark sense of humor.",
    "synopsis": "",
    "genres": ["Drama", "Mystery & Suspense", "Classics", "Science Fiction & Fantasy"],
    "posters": {
        "thumbnail": "http://content8.flixster.com/movie/11/16/80/11168026_mob.jpg",
        "profile": "http://content8.flixster.com/movie/11/16/80/11168026_pro.jpg",
        "detailed": "http://content8.flixster.com/movie/11/16/80/11168026_det.jpg",
        "original": "http://content8.flixster.com/movie/11/16/80/11168026_ori.jpg"
    },
    "director": "Stanley Kubrick"
}, {
    "id": 771203681,
    "title": "A Dangerous Method",
    "year": 2011,
    "mpaaRating": "R",
    "criticsConsensus": "A provocative historical fiction about the early days of psychoanalysis, A Dangerous Method is buoyed by terrific performances by Michael Fassbender, Keira Knightley, and Viggo Mortensen.",
    "synopsis": "Seduced by the challenge of an impossible case, the driven Dr. Carl Jung (Michael Fassbender) takes the unbalanced yet beautiful Sabina Spielrein (Keira Knightley) as his patient in A Dangerous Method. Jung's weapon is the method of his master, the renowned Sigmund Freud (Viggo Mortensen). Both men fall under Sabina's spell. -- (C) Sony Pictures Classics",
    "genres": ["Mystery & Suspense", "Drama"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/11/16/10/11161096_mob.jpg",
        "profile": "http://content6.flixster.com/movie/11/16/10/11161096_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/11/16/10/11161096_det.jpg",
        "original": "http://content6.flixster.com/movie/11/16/10/11161096_ori.jpg"
    },
    "director": "David Cronenberg"
}, {
    "id": 377006508,
    "title": "A fost sau n-a fost?, (12:08 East of Bucharest)",
    "year": 2006,
    "mpaaRating": "Unrated",
    "criticsConsensus": "With a witty script full of satirical overtones and dry humor, 12:08 East of Bucharest is a thoroughly enjoyable Romanian comedy.",
    "synopsis": "",
    "genres": ["Drama", "Art House & International", "Comedy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/41/08/83/4108836_mob.jpg",
        "profile": "http://content6.flixster.com/movie/41/08/83/4108836_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/41/08/83/4108836_det.jpg",
        "original": "http://content6.flixster.com/movie/41/08/83/4108836_ori.jpg"
    },
    "director": "Corneliu Porumboiu"
}, {
    "id": 8573,
    "title": "A History of Violence",
    "year": 2005,
    "mpaaRating": "R",
    "criticsConsensus": "A History of Violence raises compelling and thoughtful questions about the nature of violence, while representing a return to form for director David Cronenberg in one of his more uncharacteristic pieces.",
    "synopsis": "",
    "genres": ["Drama", "Action & Adventure", "Mystery & Suspense"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/25/03/250311_mob.jpg",
        "profile": "http://content9.flixster.com/movie/25/03/250311_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/25/03/250311_det.jpg",
        "original": "http://content9.flixster.com/movie/25/03/250311_ori.jpg"
    },
    "director": "David Cronenberg"
}, {
    "id": 26,
    "title": "A Lot Like Love",
    "year": 2005,
    "mpaaRating": "PG-13",
    "criticsConsensus": "A tiresome rom-com.",
    "synopsis": "",
    "genres": ["Drama", "Romance", "Comedy"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/11/17/08/11170875_mob.jpg",
        "profile": "http://content9.flixster.com/movie/11/17/08/11170875_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/11/17/08/11170875_det.jpg",
        "original": "http://content9.flixster.com/movie/11/17/08/11170875_ori.jpg"
    },
    "director": "Nigel Cole"
}, {
    "id": 13408,
    "title": "A Perfect Murder",
    "year": 1998,
    "mpaaRating": "R",
    "criticsConsensus": "A slick little thriller that relies a bit too much on surprise events to generate suspense.",
    "synopsis": "",
    "genres": ["Mystery & Suspense"],
    "posters": {
        "thumbnail": "http://content8.flixster.com/movie/11/16/79/11167914_mob.jpg",
        "profile": "http://content8.flixster.com/movie/11/16/79/11167914_pro.jpg",
        "detailed": "http://content8.flixster.com/movie/11/16/79/11167914_det.jpg",
        "original": "http://content8.flixster.com/movie/11/16/79/11167914_ori.jpg"
    },
    "director": "Andrew Davis"
}, {
    "id": 14303,
    "title": "A Thousand Acres",
    "year": 1997,
    "mpaaRating": "R",
    "criticsConsensus": "A Thousand Acres makes disappointingly sudsy stuff out of the source material, but benefits from solid performances by a strong cast.",
    "synopsis": "",
    "genres": ["Drama"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/10/88/70/10887047_mob.jpg",
        "profile": "http://content9.flixster.com/movie/10/88/70/10887047_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/10/88/70/10887047_det.jpg",
        "original": "http://content9.flixster.com/movie/10/88/70/10887047_ori.jpg"
    },
    "director": "Jocelyn Moorhouse"
}, {
    "id": 10093,
    "title": "A Walk to Remember",
    "year": 2002,
    "mpaaRating": "PG",
    "criticsConsensus": "Though wholesome, the Mandy Moore vehicle A Walk to Remember is also bland and oppressively syrupy.",
    "synopsis": "",
    "genres": ["Drama", "Romance"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/11/16/94/11169452_mob.jpg",
        "profile": "http://content6.flixster.com/movie/11/16/94/11169452_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/11/16/94/11169452_det.jpg",
        "original": "http://content6.flixster.com/movie/11/16/94/11169452_ori.jpg"
    },
    "director": "Adam Shankman"
}, {
    "id": 13852,
    "title": "About Schmidt",
    "year": 2002,
    "mpaaRating": "R",
    "criticsConsensus": "In this funny, touching character study, Nicholson gives one of the best performances of his career.",
    "synopsis": "",
    "genres": ["Drama", "Comedy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/10/89/01/10890128_mob.jpg",
        "profile": "http://content6.flixster.com/movie/10/89/01/10890128_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/10/89/01/10890128_det.jpg",
        "original": "http://content6.flixster.com/movie/10/89/01/10890128_ori.jpg"
    },
    "director": "Alexander Payne"
}, {
    "id": 248007808,
    "title": "Accepted",
    "year": 2006,
    "mpaaRating": "PG-13",
    "criticsConsensus": "Like its characters who aren't able to meet their potential, Accepted's inconsistent and ridiculous plot gets annoying, despite a few laughs.",
    "synopsis": "",
    "genres": ["Comedy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/10/88/98/10889888_mob.jpg",
        "profile": "http://content6.flixster.com/movie/10/88/98/10889888_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/10/88/98/10889888_det.jpg",
        "original": "http://content6.flixster.com/movie/10/88/98/10889888_ori.jpg"
    },
    "director": "Steve Pink"
}, {
    "id": 13212,
    "title": "Adaptation",
    "year": 2002,
    "mpaaRating": "R",
    "criticsConsensus": "Dizzyingly original, the loopy, multi-layered Adaptation is both funny and thought-provoking.",
    "synopsis": "",
    "genres": ["Drama", "Comedy"],
    "posters": {
        "thumbnail": "http://content6.flixster.com/movie/26/86/268624_mob.jpg",
        "profile": "http://content6.flixster.com/movie/26/86/268624_pro.jpg",
        "detailed": "http://content6.flixster.com/movie/26/86/268624_det.jpg",
        "original": "http://content6.flixster.com/movie/26/86/268624_ori.jpg"
    },
    "director": "Spike Jonze"
}, {
    "id": 770684787,
    "title": "Adventureland",
    "year": 2009,
    "mpaaRating": "R",
    "criticsConsensus": "Full of humor and nostalgia, Adventureland is a sweet, insightful coming-of-age comedy that will resonate with teens and adults alike.",
    "synopsis": "",
    "genres": ["Drama", "Comedy"],
    "posters": {
        "thumbnail": "http://content8.flixster.com/movie/11/15/74/11157478_mob.jpg",
        "profile": "http://content8.flixster.com/movie/11/15/74/11157478_pro.jpg",
        "detailed": "http://content8.flixster.com/movie/11/15/74/11157478_det.jpg",
        "original": "http://content8.flixster.com/movie/11/15/74/11157478_ori.jpg"
    },
    "director": "Greg Mottola"
}, {
    "id": 16823,
    "title": "Air Force One",
    "year": 1997,
    "mpaaRating": "R",
    "criticsConsensus": "This late-period Harrison Ford actioner is full of palpable, if not entirely seamless, thrills.",
    "synopsis": "",
    "genres": ["Drama", "Action & Adventure", "Mystery & Suspense"],
    "posters": {
        "thumbnail": "http://content9.flixster.com/movie/11/16/93/11169367_mob.jpg",
        "profile": "http://content9.flixster.com/movie/11/16/93/11169367_pro.jpg",
        "detailed": "http://content9.flixster.com/movie/11/16/93/11169367_det.jpg",
        "original": "http://content9.flixster.com/movie/11/16/93/11169367_ori.jpg"
    },
    "director": "Wolfgang Petersen"
}];

var bodyParser = require('body-parser');
var express = require('express');
var router = express.Router();
router.use(bodyParser.json());
router.use(bodyParser.urlencoded({extended: true}));

router.get('/', function (req, res) {
    var count = 0;
    var result = movies.filter(function () {
        return count++ < 100;
    });
    res.json(result);
});

router.get('/:id', function (req, res) {
    var id = +req.params.id;
    var movie = movies.filter(function (m) {
        return m.id === id;
    }).pop();
    res.json(movie);
});

router.post('/', function (req, res) {
    var movie = req.body;
    movie.id = movie.id || Date.now();
    movies.unshift(movie);

    var fullUrl = req.protocol + '://' + req.get('host') + req.originalUrl;
    res.location(fullUrl + '/' + movie.id);
    res.statusCode = 201;
    res.end();
});

router.put('/:id', function (req, res) {
    var newMovie = req.body;
    newMovie.id = +newMovie.id;

    var id = +req.params.id;
    var oldMovie = movies.filter(function (m) {
        return m.id === id;
    }).pop();
    var index = movies.indexOf(oldMovie);
    movies[index] = newMovie;

    res.statusCode = 204;
    res.end();
});

router.delete('/:id', function (req, res) {
    var id = +req.params.id;
    var movie = movies.filter(function (m) {
        return m.id === id;
    }).pop();
    var index = movies.indexOf(movie);
    movies.splice(index, 1);

    res.statusCode = 204;
    res.end();
});

module.exports = router;